<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Liste de Decks</title>
</head>

<body>
    <h1>Liste de Decks</h1>


    <div th:if="${not #lists.isEmpty(decks)}"></div>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Nom</th>
                <th>Description</th>
                <th>Matiere</th>
                <th>Delete</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="deck : ${decks}">
                <td th:text="${deck.id}">ID</td>
                <td th:text="${deck.name}">Nom</td>
                <td th:text="${deck.description}">Description</td>
                <td th:text="${deck.matiere.name}">Matiere</td>

                <td>
                    <button class="btn btn-danger" th:onclick="'javascript:deleteDeck(' + ${deck.id} + ')'">
                        <span class="fa fa-trash"></span> Delete
                    </button>
                </td>
                <td>
                    <a th:href="@{/main/deck/edit/{id}(id=${deck.id})}">Edit</a>
                </td>

            </tr>
        </tbody>
    </table>
    </div>
    <div th:if="${#lists.isEmpty(decks)}">
        <p>No deck available.</p>
    </div>

    <a href="/main">Nouveau deck</a>
</body>

</html>

<script>
    function deleteDeck(deckId) {
        console.log("Deleting deck " + deckId)

        if (confirm("Are you sure you want to delete this deck?")) {
            // Send a DELETE request using AJAX
            fetch(`/main/deck/delete/${deckId}`, {
                method: 'GET'
            })
                .then(response => {
                    if (response.ok) {
                        // Handle successful deletion
                        // You can reload the page or update the deck list as needed
                        location.reload();
                    } else {
                        // Handle deletion failure
                        alert('Failed to delete the deck.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
    }
</script>